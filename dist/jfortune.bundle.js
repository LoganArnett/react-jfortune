!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define("jfortune",["react"],t):"object"==typeof exports?exports.jfortune=t(require("react")):e.jfortune=t(e.react)}(this,function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";function i(e,t){var n=t-e,i=n+1;return Math.floor(Math.random()*i)+e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=400,r=function(e){return 1/(200*e)},o=function(e,t,n,o){var s=3*e,a=3*(n-e)-s,u=1-s-a,c=3*t,p=3*(o-t)-c,f=1-c-p,l=function(e){return((u*e+a)*e+s)*e},h=function(e){return((f*e+p)*e+c)*e},d=function(e){return(3*u*e+2*a)*e+s},m=function(e,t){var n,i,r,o,s,a;for(r=e,a=0;a<8;a++){if(o=l(r)-e,Math.abs(o)<t)return r;if(s=d(r),Math.abs(s)<1e-6)break;r-=o/s}if(n=0,i=1,r=e,r<n)return n;if(r>i)return i;for(;n<i;){if(o=l(r),Math.abs(o-e)<t)return r;e>o?n=r:i=r,r=.5*(i-n)+n}return r},y=function(e,t){return h(m(e,t))};return function(e,t){return y(e,r(+t||i))}};t.default={linear:o(0,0,1,1),ease:o(.25,.1,.25,1),easeIn:o(.42,0,1,1),easeOut:o(0,0,.58,1),easeInOut:o(.42,0,.58,1),cubicBezier:function(e,t,n,i,r,s){return o(e,t,n,i)(r,s)}}},function(t,n){t.exports=e},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=[[Math.cos(e),Math.sin(e),0,0],[Math.sin(-e),Math.cos(e),0,0],[0,0,1,0],[0,0,0,1]],n=function(e,t,n){return e+(n>0?",":"")+t.join(",")};return t.reduce(n,"")}function u(e){var t="matrix3d("+e+")";return{transform:t,WebkitTransform:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.JFortuneDirection=t.createTransformFromMatrix3d=t.matrix3dRotateZ=t.default=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=n(2),f=i(p),l=n(1),h=i(l),d=n(0),m=i(d),y=function(e){throw Error(e+" must be defined!")},v=Object.freeze({__proto__:null,CLOCKWISE:1,COUNTER_CLOCKWISE:-1}),b=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=Object.assign({},t.defaultOptions,e.options),s=i.prices,a=void 0===s?y("options.prices"):s,u=Array.isArray(a)?a.length:a,c=360/u;return n.direction=i.direction,n.spin=n.spin.bind(n),n.doSpin=n.doSpin.bind(n),n.state={options:i,total:u,gap:c},n}return s(t,e),c(t,[{key:"spin",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.options.direction,i=arguments[2],r=this.state,o=r.options,s=r.total,a=r.gap;if(this.deferred=new Promise(function(e,n){t.fulfilled=e,t.rejected=n}),i)this.price=e,this.stop=this.directionMultiplier(n)*i;else{this.price="number"==typeof e?e:Math.floor(Math.random()*s);var u=(0,m.default)(o.separation,a-o.separation),c="counterclockwise"===this.direction?s-this.price:this.price,p=a*(c-.5),f=p+u,l=(0,m.default)(o.minSpins,o.maxSpins),h=360*l;this.stop=this.directionMultiplier(n)*(h+f)}return this.prev_angle=this.start_time=0,this.spin_frame=requestAnimationFrame(this.doSpin),this.deferred}},{key:"directionMultiplier",value:function(){return this.direction===v.COUNTER_CLOCKWISE?-1:1}},{key:"doSpin",value:function(e){this.start_time=this.start_time||e;var t=e-this.start_time,n=this.state,i=n.options.bezier,r=n.options;if(t<r.duration){var o=t/r.duration,s=h.default.cubicBezier(i.p1x,i.p1y,i.p2x,i.p2y,o);this.angle=s*this.stop,this.rotate(this.angle,this.direction)}else this.forceEnd();Math.abs(this.angle)<Math.abs(this.stop)?this.spin_frame=requestAnimationFrame(this.doSpin):this.fulfilled(Array.isArray(r.prices)?r.prices[this.price]:this.price)}},{key:"rotate",value:function(e,t){this.direction=t;var n=this.directionMultiplier();this.angle=e,this.doRotate(e);var i=this.needsBounce();i?(1!==i&&this.state.isBouncing||this.state.options.onSpinBounce(this),this.doSpinnerBounce(n)):this.stopSpinnerBounce(),this.prev_angle=this.angle}},{key:"forceEnd",value:function(){var e=this.state.options;this.spinFrame&&cancelAnimationFrame(this.spinFrame),this.rotate(this.stop,this.direction),this.stopSpinnerBounce(),this.deferred&&this.fulfilled(Array.isArray(e.prices)?e.prices[this.price]:this.price)}},{key:"needsBounce",value:function(){var e=this.state,t=e.gap,n=e.options,i=.5*t,r=Math.abs((i+this.angle)%t),o=Math.abs(this.angle-this.prev_angle),s=.5*n.separatorThickness,a=t-s;return o>=i?1:r<s||r>a?2:0}},{key:"doRotate",value:function(e){var t=a(e*Math.PI/180);this.setState({wheelMatrix:t})}},{key:"doSpinnerBounce",value:function(e){var t=a(5*e*Math.PI/180);this.setState({spinnerMatrix:t,isBouncing:!0})}},{key:"stopSpinnerBounce",value:function(){var e=a(0);this.setState({spinnerMatrix:e,isBouncing:!1})}},{key:"render",value:function(){var e=this.props.spinnerText,t=this.state,n=t.spinnerMatrix,i=t.wheelMatrix,r=t.options,o=r.wheelClassname,s=r.spinnerClassname;return f.default.createElement("div",null,f.default.createElement("div",{className:o,style:u(i)}),f.default.createElement("div",{className:s,style:u(n)},e))}}]),t}(p.Component);b.propTypes={options:p.PropTypes.object.isRequired,spinnerText:p.PropTypes.string.isRequired},b.defaultOptions={duration:1e3,separation:5,minSpins:10,maxSpins:15,direction:v.CLOCKWISE,wheelClassname:"wheel",spinnerClassname:"spinner",bezier:{p1x:.17,p1y:.67,p2x:.12,p2y:.99},separatorThickness:7,onSpinBounce:Function.prototype},t.default=b,t.matrix3dRotateZ=a,t.createTransformFromMatrix3d=u,t.JFortuneDirection=v}])});
